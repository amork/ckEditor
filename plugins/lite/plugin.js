/* Source version: 1.2.20 */
(function(h){var x={Events:{INIT:"lite:init",ACCEPT:"lite:accept",REJECT:"lite:reject",SHOW_HIDE:"lite:showHide",TRACKING:"lite:tracking",CHANGE:"lite:change",HOVER_IN:"lite:hover-in",HOVER_OUT:"lite:hover-out"},Commands:{TOGGLE_TRACKING:"lite-toggletracking",TOGGLE_SHOW:"lite-toggleshow",ACCEPT_ALL:"lite-acceptall",REJECT_ALL:"lite-rejectall",ACCEPT_ONE:"lite-acceptone",REJECT_ONE:"lite-rejectone",TOGGLE_TOOLTIPS:"lite-toggletooltips"}},r={show:true,path:"js/opentip-adapter.js",classPath:"OpentipAdapter",cssPath:"css/opentip.css",delay:500},g={deleteTag:"del",insertTag:"ins",deleteClass:"ice-del",insertClass:"ice-ins",attributes:{changeId:"data-cid",userId:"data-userid",userName:"data-username",sessionId:"data-session-id",changeData:"data-changedata",time:"data-time",lastTime:"data-last-change-time"},stylePrefix:"ice-cts",preserveOnPaste:"p",css:"css/lite.css"},u="%a by %u %t",i=/^[\s\r\n]*$/,z=[{regex:/[\s]*title=\"[^\"]+\"/g,replace:""},{regex:/[\s]*data-selected=\"[^\"]+\"/g,replace:""}],n=[],y=[h.CTRL+88,h.CTRL+120,h.SHIFT+46],e=false,j=false;function d(I){var E,D,H,G,C,J;if(I.nodeType===ice.dom.ELEMENT_NODE){var F=I.childNodes;for(G=0;G<F.length;++G){J=F[G];d(J);D=J.nodeName.toLowerCase();if(D===g.insertTag||D===g.deleteTag){while(J.firstChild){I.insertBefore(J.firstChild,J)}I.removeChild(J)}}}D=I.nodeName.toLowerCase();if(D==="ins"||D==="del"){E=jQuery.makeArray(I.childNodes)}else{E=[I]}return E}function k(C){if(!C||!C.length){return[]}var D=[];C.forEach(function(E){D=D.concat(d(E))});return D}function q(C){return y.indexOf(C)>=0}function m(C){if(C&&C.$&&(typeof C.getDocument==="function")){return C.$}return C}function o(D){for(var C=n.length;C--;){var E=n[C];if(E.editor==D){return C}}return -1}function c(C){var D=o(C);return D>=0?n[D]:null}function p(C){var D=c(C);return D&&D.plugin}function t(C,D){n.push({plugin:D,editor:C})}function w(E,F,C,H){if(null===E||(typeof(E)=="undefined")){E=""}else{E=String(E)}C=String(C);var G=C.length;for(var D=E.length;D<F;D+=G){if(H){E+=C}else{E=C+E}}return E}function A(C,D){return w(C,D,"0")}function a(E){var D=new Date(),I=D.getDate(),G=D.getMonth(),H=D.getFullYear(),F,J;var K=typeof(E);if(K=="string"||K=="number"){E=new Date(E)}var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];if(I==E.getDate()&&G==E.getMonth()&&H==E.getFullYear()){F=Math.floor((D.getTime()-E.getTime())/60000);if(F<1){return"now"}else{if(F<2){return"1 minute ago"}else{if(F<60){return(F+" minutes ago")}else{J=E.getHours();F=E.getMinutes();return"on "+A(J,2)+":"+A(F,2,"0")}}}}else{if(H==E.getFullYear()){return"on "+C[E.getMonth()]+" "+E.getDate()}else{return"on "+C[E.getMonth()]+" "+E.getDate()+", "+E.getFullYear()}}}function v(){if(e){return}e=true;var C=parseFloat(h.version);j=isNaN(C)||C<4.4}function B(E,F){var D,C=F&&F.length;if(!E||!C){return false}for(D=0;D<C;++D){if(E.is(F[D])){return true}}return false}h.plugins.add("lite",{icons:"lite-acceptall,lite-acceptone,lite-rejectall,lite-rejectone,lite-toggleshow,lite-toggletracking",hidpi:true,_scriptsLoaded:null,init:function(J){v();var G=c(J);if(G){return}var O=this.path,I=new f(O),C=h.tools.extend({},J.config.lite||{}),L=C.tooltips;if(undefined===L){L=true}if(L===true){L=r}C.tooltips=L;t(J,I);I.init(J,C);J.on("destroy",(function(P){var Q=o(P);if(Q>=0){n.splice(Q,1)}}).bind(this));if(this._scriptsLoaded){I._onScriptsLoaded();return}else{if(this._scriptsLoaded===false){return}}this._scriptsLoaded=false;var D=(typeof(jQuery)=="function"),N=this,E=C.jQueryPath||"js/jquery.min.js",F=(C.includeType?C["includes_"+C.includeType]:C.includes)||["lite-includes.js"];F=F.slice();for(var H=0,K=F.length;H<K;++H){F[H]=O+F[H]}if(!D){F.splice(0,0,this.path+E)}if(L.path){F.push(this.path+L.path)}var M=function(){if(F.length<1){N._scriptsLoaded=true;if(!D){jQuery.noConflict()}jQuery.each(n,(function(Q,R){R.plugin._onScriptsLoaded()}))}else{var P=F.shift();h.scriptLoader.load(P,function(){M()},N)}};M(F)},findPlugin:function(C){return p(C)},startNewSession:function(C){var D=p(C);if(D){D.startNewSession()}else{b("startNewSession: plugin not found")}}});var f=function(C){this.path=C};f.prototype={init:function(J,F){this._editor=J;this._domLoaded=false;this._editor=null;this._tracker=null;this._isVisible=true;this._liteCommandNames=[];this._canAcceptReject=true;this._removeBindings=[];J.ui.addToolbarGroup("lite");this._setPluginFeatures(J,g);this._changeTimeout=null;this._notifyChange=this._notifyChange.bind(this);this._notifyTextChange=this._notifyTextChange.bind(this);this._config=F;var C=F.acceptRejectInReadOnly===true;var D=[{command:x.Commands.TOGGLE_TRACKING,exec:this._onToggleTracking,title:"Toggle Tracking Changes",trackingOnly:false},{command:x.Commands.TOGGLE_SHOW,exec:this._onToggleShow,title:"Toggle Tracking Changes",readOnly:true},{command:x.Commands.ACCEPT_ALL,exec:this._onAcceptAll,title:"Accept all changes",readOnly:C},{command:x.Commands.REJECT_ALL,exec:this._onRejectAll,title:"Reject all changes",readOnly:C},{command:x.Commands.ACCEPT_ONE,exec:this._onAcceptOne,title:"Accept Change",readOnly:C},{command:x.Commands.REJECT_ONE,exec:this._onRejectOne,title:"Reject Change",readOnly:C},{command:x.Commands.TOGGLE_TOOLTIPS,exec:this._onToggleTooltips,readOnly:true}];this._isTracking=F.isTracking!==false;this._trackingState=null;this._eventsBounds=false;J.on("contentDom",(function(N){this._onDomLoaded(N)}).bind(this));J.on("dataReady",(function(N){this._onAfterSetData(N)}).bind(this));var M=this.path;var E=F.commands||[x.Commands.TOGGLE_TRACKING,x.Commands.TOGGLE_SHOW,x.Commands.ACCEPT_ALL,x.Commands.REJECT_ALL,x.Commands.ACCEPT_ONE,x.Commands.REJECT_ONE];var L=this;function I(O){J.addCommand(O.command,{exec:O.exec.bind(L),readOnly:O.readOnly||false});if(O.title&&E.indexOf(O.command)>=0){var N=L._commandNameToUIName(O.command);J.ui.addButton(N,{label:O.title,command:O.command,toolbar:"lite"});if(O.trackingOnly!==false){L._liteCommandNames.push(O.command)}}}for(var H=0,K=D.length;H<K;++H){I(D[H])}if(F.contextMenu!==false){if(J.addMenuItems){J.addMenuGroup("lite",50);var G={};if(E.indexOf(x.Commands.ACCEPT_ONE)>=0){G[x.Commands.ACCEPT_ONE]={label:"Accept Change",command:x.Commands.ACCEPT_ONE,group:"lite",order:1}}if(E.indexOf(x.Commands.REJECT_ONE)>=0){G[x.Commands.REJECT_ONE]={label:"Reject Change",command:x.Commands.REJECT_ONE,group:"lite",order:2}}J.addMenuItems(G)}if(J.contextMenu){J.contextMenu.addListener((function(O){if(O&&this._tracker&&this._tracker.currentChangeNode(O)){var N={};N[x.Commands.ACCEPT_ONE]=h.TRISTATE_OFF;N[x.Commands.REJECT_ONE]=h.TRISTATE_OFF;return N}else{return null}}).bind(this))}}},toggleTracking:function(C,D){if("boolean"===typeof D){D={notify:D}}D=D||{};var I=(undefined===C)?!this._isTracking:C,H=this._editor,G=D&&D.force;if(!I&&this._isTracking&&!G){var E=this._tracker.countChanges({verify:true});if(E){return window.alert("Your document containssome pending changes.\nPlease resolve them before turning off change tracking.")}}this._isTracking=I;this._setCommandsState(this._liteCommandNames,I?h.TRISTATE_OFF:h.TRISTATE_DISABLED);this._updateTrackingState();this.toggleShow(I,false);this._setCommandsState(x.Commands.TOGGLE_TRACKING,I?h.TRISTATE_ON:h.TRISTATE_OFF);var F=H.ui.get(this._commandNameToUIName(x.Commands.TOGGLE_TRACKING));if(F){this._setButtonTitle(F,I?"Stop tracking changes":"Start tracking changes")}if(D.notify!==false){H.fire(x.Events.TRACKING,{tracking:I,lite:this})}},toggleShow:function(C,D){var F=(typeof(C)=="undefined")?(!this._isVisible):C;this._isVisible=F;if(this._isTracking){this._setCommandsState(x.Commands.TOGGLE_SHOW,F?h.TRISTATE_ON:h.TRISTATE_OFF)}this._tracker.setShowChanges(F&&this._isTracking);var E=this._editor.ui.get(this._commandNameToUIName(x.Commands.TOGGLE_SHOW));if(E){this._setButtonTitle(E,F?"Hide tracked changes":"Show tracked changes")}if(D!==false){this._editor.fire(x.Events.SHOW_HIDE,{show:F,lite:this})}},isVisible:function(){return this._isVisible},isTracking:function(){return this._isTracking},acceptAll:function(C){this._tracker.acceptAll(C);this._cleanup();this._editor.fire(x.Events.ACCEPT,{lite:this,options:C})},rejectAll:function(C){this._tracker.rejectAll(C);this._cleanup();this._editor.fire(x.Events.REJECT,{lite:this,options:C})},setUserInfo:function(C){C=C||{};this._config.userId=String(C.id);this._config.userName=C.name||"";if(this._tracker){this._tracker.setCurrentUser({id:this._config.userId,name:this._config.userName})}},getUserInfo:function(){return this._tracker?this._tracker.getCurrentUser():{name:"",id:""}},countChanges:function(C){return(this._tracker&&this._tracker.countChanges(C))||0},enableAcceptReject:function(C){this._canAcceptReject=Boolean(C);this._onIceChange()},filterIceElement:function(C){if(!C){return true}try{if(C.hasClass(g.insertClass)||C.hasClass(g.deleteClass)){return false}}catch(C){}return true},startNewSession:function(){var C=new Date();this._sessionId=String.fromCharCode(65+Math.round(Math.random()*26))+C.getDate()+C.getDay()+C.getHours()+C.getMinutes()+C.getMilliseconds();if(this._tracker){this._tracker.setSessionId(this._sessionId)}},getCleanMarkup:function(D){if(null===D||undefined===D){D=(this._editor&&this._editor.getData())||""}for(var C=z.length-1;C>=0;--C){D=D.replace(z[C].regex,z[C].replace)}return D},getCleanText:function(){var C=this._getBody();if(!C){return""}var E=[];E.push("");var D=this._tracker.getDeleteClass();this._getCleanText(C,E,D);var F=E.join("\n");F=F.replace(/&nbsp(;)?/ig," ");return F},acceptChange:function(C){C=m(C);if(C&&this._tracker){this._tracker.acceptChange(C);this._cleanup();this._editor.fire(x.Events.ACCEPT,{lite:this});this._onSelectionChanged(null)}},rejectChange:function(C){C=m(C);if(C&&this._tracker){this._tracker.rejectChange(C);this._cleanup();this._editor.fire(x.Events.REJECT,{lite:this});this._onSelectionChanged(null)}},getChanges:function(C){return(this._tracker&&this._tracker.getChanges(C))||{}},_getCleanText:function(H,G,F){var E=H.getAttribute("class");if(E&&E.indexOf(F)>=0){return}var C;if(C=((H.nodeName&&H.nodeName.toUpperCase()=="BR")||("block"==jQuery(H).css("display")))){if(i.test(G[G.length-1])){G[G.length-1]=""}else{G.push("")}}for(var I=H.firstChild;I;I=I.nextSibling){var D=I.nodeType;if(3==D){G[G.length-1]+=String(I.nodeValue)}else{if(1==D||9==D||11==D){this._getCleanText(I,G,F)}}}if(C){G.push("")}},_onDomLoaded:function(D){this._domLoaded=true;this._editor=D.editor;var C=this._editor.editable();C.attachListener(C,"mousedown",this._onMouseDown,this,null,1);C.attachListener(C,"keypress",this._onKeyPress,this,null,1);this._hideTooltip();this._onReady()},_onScriptsLoaded:function(){this._scriptsLoaded=true;this._onReady()},_loadCSS:function(H,C){var E=H.getElementsByTagName("head")[0],D=C.cssPath,F=this.path;function G(J,K){if(!J){return}var I=jQuery(E).find("#"+K);if(!I.length){I=H.createElement("link");I.setAttribute("rel","stylesheet");I.setAttribute("type","text/css");I.setAttribute("id",K);I.setAttribute("href",F+J);E.appendChild(I)}}if(D!==false){G(D||C.defaultCssPath,"__lite__css__")}if(this._config.tooltips.cssPath){G(this._config.tooltips.cssPath,"__lite_tt_css__")}},_onReady:function(){if(!this._scriptsLoaded||!this._domLoaded){return}setTimeout(this._afterReady.bind(this),5)},_getBody:function(){try{return this._editor.editable().$}catch(C){return null}},_afterReady:function(){var J=this._editor,I=J.document.$,C=this._getBody(),F=this._config,D=(F&&F.debug)||{};this._loadCSS(I,{cssPath:F.cssPath,defaultCssPath:"css/lite.css"});if(!this._eventsBounds){this._eventsBounds=true;var H=this._onPaste.bind(this);J.on("afterCommandExec",this._onAfterCommand.bind(this));J.on("beforeCommandExec",this._onBeforeCommand.bind(this));if(this._config.handlePaste){J.on("paste",H,null,null,1)}J.on("beforeGetData",this._onBeforeGetData.bind(this));J.on("beoreUndoImage",this._onBeforeGetData.bind(this));J.on("insertHtml",H,null,null,1);J.on("insertText",H,null,null,1);J.on("insertElement",H,null,null,1);J.on("mode",this._onModeChange.bind(this),null,null,1);J.on("readOnly",this._onReadOnly.bind(this))}if(this._tracker){if(C!=this._tracker.getContentElement()){this._tracker.stopTracking(true);jQuery(this._tracker).unbind();this._tracker=null}}if(this._tracker){return}var E={element:C,mergeBlocks:false,currentUser:{id:F.userId||"",name:F.userName||""},userStyles:F.userStyles,changeTypes:{insertType:{tag:g.insertTag,alias:g.insertClass,action:"Inserted"},deleteType:{tag:g.deleteTag,alias:g.deleteClass,action:"Deleted"}},hostMethods:{getHostRange:this._getHostRange.bind(this),getHostRangeData:this._getHostRangeData.bind(this),makeHostElement:function(K){return new h.dom.element(K)},getHostNode:function(K){return K&&K.$},setHostRange:this._setHostRange.bind(this),hostCopy:this._hostCopy.bind(this),beforeEdit:this._beforeEdit.bind(this),notifyChange:this._afterEdit.bind(this)}};if(D.log){E.hostMethods.logError=b}E.tooltips=F.tooltips.show;if(E.tooltips){var G=this._hideTooltip.bind(this);E.hostMethods.showTooltip=this._showTooltip.bind(this);E.hostMethods.hideTooltip=G;E.hostMethods.beforeDelete=E.hostMethods.beforeInsert=G;if(F.tooltips.classPath){try{this._tooltipsHandler=new window[F.tooltips.classPath]();E.tooltipsDelay=F.tooltips.delay}catch(J){}if(!this._tooltipsHandler){b("Unable to create tooltip handler",F.tooltips.classPath)}else{this._tooltipsHandler.init(F.tooltips)}}}jQuery.extend(E,g);this._tracker=new ice.InlineChangeEditor(E);try{this._tracker.startTracking();this.toggleTracking(this._isTracking,false);this._updateTrackingState();jQuery(this._tracker).on("change",this._onIceChange.bind(this)).on("textChange",this._onIceTextChanged.bind(this));J.fire(x.Events.INIT,{lite:this});this._onSelectionChanged(null);this._onIceChange(null)}catch(J){b("ICE plugin init:",J)}},_onToggleShow:function(){this.toggleShow()},_onToggleTracking:function(){this.toggleTracking()},_onRejectAll:function(){this.rejectAll()},_onAcceptAll:function(){this.acceptAll()},_onAcceptOne:function(){var C=this._tracker.currentChangeNode();return this.acceptChange(C)},_onRejectOne:function(){var C=this._tracker.currentChangeNode();return this.rejectChange(C)},_onToggleTooltips:function(){this._tracker&&this._tracker.toggleTooltips()},_cleanup:function(){var C=this._getBody(),D=jQuery(C).find(self.insertSelector+":empty,"+self.deleteSelector+":empty");D.remove();this._onSelectionChanged(null)},_setButtonTitle:function(C,E){var D=jQuery("#"+C._.id);D.attr("title",E)},_onAfterCommand:function(D){var C=this._tracker&&this._isTracking&&D.data&&D.data.name;if("undo"==C||"redo"==C){this._tracker.reload()}},_onBeforeCommand:function(D){var C=this._tracker&&this._tracker.isTracking()&&D.data&&D.data.name;if("cut"==C){if(l(this._editor,"copy")){this._tracker.prepareToCut()}}else{if("copy"==C){if(l(this._editor,"copy")){this._tracker.prepareToCopy()}}}},_onModeChange:function(C){this._updateTrackingState();setTimeout(this._onIceChange.bind(this),0)},_onKeyPress:function(C){var D=C&&C.data&&C.data.getKeystroke();if(q(D)){C.stop()}},_onKeyDown:function(C){if(!this._tracker||!this._tracker.isTracking()){return}var D=C.data.keyCode;if(q(D)){if(this._tracker.tryToCut()){C.stop()}}},_onMouseDown:function(){this._hideTooltip()},_onBeforeGetData:function(){this._hideTooltip()},_onAfterSetData:function(){this._hideTooltip();this._processContent();if(this._tracker){this._tracker.reload()}},_onReadOnly:function(){this._updateTrackingState()},_updateTrackingState:function(){if(this._tracker){var C=this._isTracking&&this._editor.mode==="wysiwyg"&&!this._editor.readOnly;if(C===this._trackingState){return}this._trackingState=C;this._tracker.toggleChangeTracking(C);for(var E=this._removeBindings.length-1;E>=0;--E){this._removeBindings[E].removeListener()}this._removeBindings=[];this._tracker.unlistenToEvents();if(C){var F=this._onSelectionChanged.bind(this),D=this._editor.editable();if(j){this._tracker.listenToEvents()}else{this._removeBindings.push(this._editor.on("key",function(H){if(this._tracker){var G=H.data.domEvent&&H.data.domEvent.$;return G?this._tracker.handleEvent(G):true}return true}.bind(this)))}this._removeBindings.push(D.on("keyup",this._onSelectionChanged.bind(this,null,false)));this._removeBindings.push(D.on("click",F));this._removeBindings.push(this._editor.on("selectionChange",F))}}},_onPaste:function(M){if(!this._tracker||!this._isTracking||!M){return true}var E=M.data||{},I=false,G=null,L=this._config.ignoreSelectors||[],F=window.jQuery,D=(M.name=="insertElement")&&E.$;if(!E){return}if("string"==typeof E){E={dataValue:E,type:"text"}}if(D){I=D.getAttribute("data-track-changes-ignore")}else{if(E.dataValue&&"html"==(E.type||E.mode)){try{D=jQuery(E.dataValue);I=D&&D.attr("data-track-changes-ignore")}catch(H){}}}if(I){return true}if("string"==typeof E.dataValue){try{var K=this._editor.document.$,C=K.createElement("div");C.innerHTML=String(E.dataValue);C=this._tracker.getCleanDOM(C);if(!C.innerHTML){return true}G=jQuery.makeArray(C.childNodes)}catch(H){b("ice plugin paste:",H)}}else{if(D){G=[D]}else{return true}}if(G&&L.length){G=G.filter(function(N){return !B(F(N),L)})}if(G&&G.length){G=k(G);var J=this._editor.focusManager.hasFocus;this._beforeInsert();this._tracker.insert({nodes:G});this._afterInsert();if(J){this._editor.editable().focus()}M.stop();this._onIceTextChanged()}return true},_setCommandsState:function(C,F){if(typeof(C)=="string"){C=C.split(",")}for(var D=C.length-1;D>=0;--D){var E=this._editor.getCommand(C[D]);if(E){E.setState(F)}}},_onSelectionChanged:function(E,C){var D=this._isTracking&&this._tracker&&this._tracker.isInsideChange(null,null,C),F=D&&this._canAcceptReject?h.TRISTATE_OFF:h.TRISTATE_DISABLED;this._setCommandsState([x.Commands.ACCEPT_ONE,x.Commands.REJECT_ONE],F)},_onIceChange:function(E){var C=this._isTracking&&this._tracker&&this._tracker.hasChanges();var D=C&&this._canAcceptReject?h.TRISTATE_OFF:h.TRISTATE_DISABLED;this._setCommandsState([x.Commands.ACCEPT_ALL,x.Commands.REJECT_ALL],D);this._onSelectionChanged();if(E){this._triggerChange()}},_onIceTextChanged:function(C){this._triggerChange()},_triggerChange:function(){if(!this._changeTimeout){this._changeTimeout=setTimeout(this._notifyChange,1)}},_notifyChange:function(){this._changeTimeout=null;this._editor.fire(x.Events.CHANGE,{lite:this})},_notifyTextChange:function(){this._changeTimeout=null;this._editor.fire("change",{lite:this})},_processContent:function(){var C=this._getBody(),F=window.jQuery,I=g.insertTag,E=g.deleteTag,D,G;if(!C){return}G=C.ownerDocument;function H(M,J){var L=M.parentNode,K=G.createElement(J);F.each(M.attributes,function(O,N){K.setAttribute(N.name,N.value)});K.className=M.className||"";F(M).contents().appendTo(K);L.insertBefore(K,M);L.removeChild(M)}if(I!=="span"){D=F(C).find("span."+g.insertClass);D.each(function(J,K){H(K,I)})}if(E!=="span"){D=F(C).find("span."+g.deleteClass);D.each(function(J,K){H(K,E)})}},_commandNameToUIName:function(C){return C.replace(".","_")},_setPluginFeatures:function(H,J){function F(){return[J.deleteClass,J.insertClass,J.stylePrefix+"*"]}function C(){var L=["title"];for(var M in J.attributes){if(J.attributes.hasOwnProperty(M)){var N=J.attributes[M];if((typeof N==="string")&&N.indexOf("data-")===0){L.push(N)}}}return L}function E(L){var M={};L.forEach(function(N){M[N]=true});return M}if(!H||!H.filter||!H.filter.addFeature){return}try{var D=[],K,G;K={};G={};G.classes=E(F());G.attributes=E(C());K[J.insertTag]=G;K[J.deleteTag]=h.tools.clone(G);K.br=h.tools.clone(G);K.br.propertiesOnly=true;K.span=h.tools.clone(G);H.filter.addFeature({name:"lite-features",allowedContent:K})}catch(I){b(I)}},_setHostRange:function(C){var D=this._editor&&this._editor.getSelection();if(D){D.selectRanges([C])}},_afterEdit:function(){this._editor.fire("change");this._editor.fire("saveSnapshot")},_beforeEdit:function(){h.iscutting=true;var D=this._editor,C=function(){D.fire("saveSnapshot")};C();setTimeout(function(){h.iscutting=false},100)},_hostCopy:function(){try{if(h.env.ie){s(this._editor,"copy")}else{this._editor.document.$.execCommand("copy",false,null)}}catch(C){b(C)}},_getHostRange:function(){var E=this._editor&&this._editor.getSelection(),C=E&&E.getRanges(),D=C&&C[0];return D||null},_getHostRangeData:function(C){C=C||this._getHostRange();if(!C){return null}return{startContainer:C.startContainer&&C.startContainer.$,endContainer:C.endContainer&&C.endContainer.$,startOffset:C.startOffset,endOffset:C.endOffset}},_showTooltip:function(D,F){var C=this._config.tooltips;if(C.events){return this._editor&&this._editor.fire(x.Events.HOVER_IN,{lite:this,node:D,changeId:F.changeId})}if(C.show){var E=this._makeTooltipTitle(F);if(this._tooltipsHandler){this._tooltipsHandler.hideAll(this._getBody());this._tooltipsHandler.showTooltip(D,E,this._editor.container.$)}else{D.setAttribute("title",E)}}},_hideTooltip:function(E){var D=this._config.tooltips;if(D.events){return this._editor&&this._editor.fire(x.Events.HOVER_OUT,{lite:this,node:E})}if(this._tooltipsHandler){if(E){this._tooltipsHandler.hideTooltip(E)}else{this._tooltipsHandler.hideAll(this._getBody())}}else{if(this._tracker){if(E){E.removeAttribute("title")}else{var C=this._tracker.getIceNodes();if(C){C.removeAttr("title")}}}}},_beforeInsert:function(){this._editor.fire("saveSnapshot")},_afterInsert:function(){var C=this._editor;C.getSelection().scrollIntoView()},_makeTooltipTitle:function(F){var E=this._config.tooltipTemplate||u,D=new Date(F.time),C=new Date(F.lastTime);E=E.replace(/%a/g,"insert"==F.type?"added":"deleted");E=E.replace(/%t/g,a(D));E=E.replace(/%u/g,F.userName);E=E.replace(/%dd/g,A(D.getDate(),2));E=E.replace(/%d/g,D.getDate());E=E.replace(/%mm/g,A(D.getMonth()+1,2));E=E.replace(/%m/g,D.getMonth()+1);E=E.replace(/%yy/g,A(D.getYear()-100,2));E=E.replace(/%y/g,D.getFullYear());E=E.replace(/%nn/g,A(D.getMinutes(),2));E=E.replace(/%n/g,D.getMinutes());E=E.replace(/%hh/g,A(D.getHours(),2));E=E.replace(/%h/g,D.getHours());E=E.replace(/%T/g,a(C));E=E.replace(/%DD/g,A(C.getDate(),2));E=E.replace(/%D/g,C.getDate());E=E.replace(/%MM/g,A(C.getMonth()+1,2));E=E.replace(/%M/g,C.getMonth()+1);E=E.replace(/%YY/g,A(C.getYear()-100,2));E=E.replace(/%Y/g,C.getFullYear());E=E.replace(/%NN/g,A(C.getMinutes(),2));E=E.replace(/%N/g,C.getMinutes());E=E.replace(/%HH/g,A(C.getHours(),2));E=E.replace(/%H/g,C.getHours());return E}};function b(){var C=window.console;if(C&&C.error){C.error.apply(C,[].slice.call(arguments))}}function l(C,E){if(h.env.ie){return s(C,E)}try{return C.document.$.execCommand(E,false,null)}catch(D){return false}}function s(E,H){var F=E.document,C=F.getBody(),D=false,G,I=function(){D=true};C.on(H,I);G=(h.env.version>7?F.$:F.$.selection.createRange())["execCommand"](H,false);C.removeListener(H,I);return G||D}})(window.CKEDITOR);
/* Copyright (C) 2015 LoopIndex - All Rights Reserved
 * You may use, distribute and modify this code under the
 * terms of the LoopIndex Comments CKEditor plugin license.
 *
 * You should have received a copy of the LoopIndex Comments CKEditor plugin license with
 * this file. If not, please write to: loopindex@gmail.com, or visit http://www.loopindex.com
 * written by (David *)Frenkiel (https://github.com/imdfl) 
 */